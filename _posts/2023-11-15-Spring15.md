---
layout: post
author: "Yan"
catalog: true
subtitle: "Jackson 라이브러리의 ObjectMapper"
header-img: "img/header/spring.jpg"
title: "Spring - ObjectMapper"
date: 2023-11-15 11:40:08 +0000
categories:
  - Spring
tags:
  - Spring
  - TDD
  - ObjectMapper
comments: true
---

## ObjectMapper란?

- JSON 컨텐츠를 Java 객체로 deserialization 하거나 Java 객체를 JSON으로 serialization 할 때 사용하는 Jackson 라이브러리의 클래스이다.
- ObjectMapper는 생성 비용이 비싸기 때문에 bean/static으로 처리하는 것이 좋다.

### Java 객체를 Json으로

```java
public class Car {

    private String color;
    private String type;

    // standard getters setters
}

ObjectMapper objectMapper = new ObjectMapper();
Car car = new Car("yellow", "renault");
objectMapper.writeValue(new File("target/car.json"), car);
```

결과값

```json
{"color":"yellow","type":"renault"}
```

##### `writeValueAsString` 

- 자바객체에서 string Json 반환

##### `writeValueAsBytes` 

- 자바객체에서 bytes Json 반환


### Json을 자바 객체로

```java
String json = "{ \"color\" : \"Black\", \"type\" : \"BMW\" }";
Car car = objectMapper.readValue(json, Car.class);	

Car car = objectMapper.readValue(new File("src/test/resources/json_car.json"), Car.class);
// 또는 url사용

Car car = objectMapper.readValue(new URL("file:src/test/resources/json_car.json"), Car.class);
```


## Jackson 라이브러리란?

Jackson은 JSON 데이터 구조를 처리해주는 라이브러리

### 작동 방식

-  Jackson은 JSON데이터를 출력하기 위한  `MappingJacksonHttpMessageConverter를` 제공한다. 
- 만약 스프링 `MessageConverter`를 위의 `MappingJacksonHttpMessageConverter`으로 등록한다면, 컨트롤러가 리턴하는 객체를 다시 뜯어(자바 리플렉션 사용), Jackson의 `ObjectMapper` API로 JSON 객체를 만들고 난 후, 출력하여 JSON데이터를 완성한다.
- Spring 3.1 이후로 만약 클래스패스에 Jackson 라이브러리가 존재한다면, 자동적으로 `MessageConverter`가 등록된다.

### 기본 동작 원리

- Jackson은 기본적으로 프로퍼티로 동작한다. 
- Java는 프로퍼티를 제공하는 문법이 없습니다. (멤버변수랑은 다름)
- Java의 프로퍼티는 보통 Getter 와 Setter의 이름 명명 규칙으로 정해진다.
- 프로퍼티는 Getter, Setter기준이므로 멤버변수 이름을 변경하더라도 상관 없다. 
- 많은 라이브러리가 해당 프로퍼티 개념으로 작동한다.
- JSON데이터로 출력되기 위해서는 멤버변수의 유무가 아닌 프로퍼티 즉, Getter, Setter를 기준으로 작동한다.

###### reference

> [Intro to the Jackson ObjectMapper](https://www.baeldung.com/jackson-object-mapper-tutorial)
> [[Java] ObjectMapper를 이용하여 JSON 파싱하기](https://velog.io/@zooneon/Java-ObjectMapper%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EC%97%AC-JSON-%ED%8C%8C%EC%8B%B1%ED%95%98%EA%B8%B0)    
> [[Spring] Jackson 라이브러리 이해하기.](https://mommoo.tistory.com/83)  