---
layout: post
author: "Yan"
catalog: true
subtitle: "Security & JWT"
header-img: "img/header/spring.jpg"
title: "Spring - Security"
date: 2022-08-01 11:40:08 +0000
categories:
  - Spring
tags:
  - Spring
  - JWT
  - java
comments: true
---

# 스프링 시큐리티 (Spring Security)
- 스프링 시큐리티란 어플리케이션의 보안(인증 및 인가)을 담당하는 프레임 워크
- 서블릿 필터와 이들로 구성된 필터체인으로 구성된 위임 모델을 사용한다.
- 보안 관련해서 많은 옵션을 제공해주어 개발자가 일일이 보안 관련 로직을 작성하지 않아도 된다는 장점이 있다.
- Spring Security를 사용하지 않으면 자체적으로 세션을 사용하여 체크하던가 기타 다른 방법으로 체크를 해주어야 한다.

### 장점
- 보안과 관련하여 체계적으로 많은 옵션을 제공하여 편리하게 사용할 수 있음
- Filter 기반으로 동작하여 MVC와 분리하여 관리 및 동작 
- 어노테이션을 통한 간단한 설정
- Spring Security는 기본적으로 세션 & 쿠키방식으로 인증

### 인증과 인가
- 인증`Authentication`: 해당 사용자가 본인이 맞는지를 확인하는 절차
- 인가`Authorization`: 인증된 사용자가 요청한 자원에 접근 가능한지를 결정하는 절차
- Spring Security는 기본적으로 인증 절차를 거친 후에 인가 절차를 진행하게 된다.
- 인가 과정에서 해당 리소스에 대한 접근 권한이 있는지 확인한다.
- Spring Security에서는 이러한 인증과 인가를 위해 Principal을 아이디로, Credential을 비밀번호로 사용하는 Credential 기반의 인증 방식을 사용한다. 

### Spring Security 적용시 필수 구현

- Spring Security Dependency
- Spring Security Config
- UserDetailsService 상속
- loadUserByUsername
- CSRF Token Header

# JWT

- RFC 7519 웹 표준으로 지정되어 있다.
- JSON 객체를 사용해서 토큰 자체에 정보를 저장하고 있는 Web Token이다.
- 헤비하지 않게 사용 가능하다.

## JWT의 구성
- **Header** : Signature를 해싱하기 위한 알고리즘 정보가 담겨 있다.
- **Payload** : 서버와 클라이언트가 주고 받는 시스템에서 실제로 사용될 정보를 담고 있다.
- **Signature** : 토큰의 유효성 검증을 위한 문자열. 이 문자열을 통해 서버에서는 이 토큰이 유효한 토큰인지 검증할 수 있다.

### JWT의 장점
- 중앙의 인증서버, 데이터 스토어에 대한 의존성이 없다.
- 시스템 수평적 확장에 유리하다.
- Base64 URL Safe Encoding > URL, Cookie, Header 모두 사용이 가능하다.

### JWT의 단점
- Payload의 정보가 많아지면 네트워크 사용량이 증가한다. 
- 데이터 설계를 고려할 필요가 있다.
- 토큰이 클라이언트에 저장된다. 서버에서 클라이언트의 토큰을 조작할 수 없다.

###### reference

> [Spring boot - security-jwt 연동과 흐름(feat.AccessToken, RefreshToken)](https://kdg-is.tistory.com/228)  
